
<!DOCTYPE html>

<html>
<!-- tutorial from stack overflow how to record ID https://stackoverflow.com/questions/4825295/onclick-to-get-the-id-of-the-clicked-button tutorial from stack overflow how to record ID https://stackoverflow.com/questions/4825295/onclick-to-get-the-id-of-the-clicked-button -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>STS Web Portal</title>
  <link href="../core/common.css" rel="stylesheet" type="text/css" />
  <link href="style.css" rel="stylesheet" type="text/css" />
</head>

<body>
  <form>
    Please put your name: <input type="text" name= "name", id="name">
    <button id="textinput" type="button" onclick="makePerson()">Accept</button> 
  </form>
  <div > 
    Confirm location
  </div>
<article class="circle-wrapper" >
  <template id="DialogBox">
    <div>
      <input type="text" name="Feeling" id="feeling" onsubmit="sendfeeling()">

    </div>

  </template>

  <svg id="middle" viewBox="0 0 550 550" width="20em" onlick="spawnQuestion()">
    <clipPath id="clip">
        <circle cx="280" cy="280" r="250"></circle>
    </clipPath>
    <image href="test.jpg" x="-150" y="-150" width="60em" height="60em" clip-path="url(#clip)"/>
    <circle id="statcircle" style="stroke: var(--available); fill: none; stroke-width: 2em;" cx="280" cy="280" r="250"></circle>
    <text style="font-size: 10em" x="350" y="500">ðŸ˜Š</text>
  </svg>
  <div class="circle deg-0">
    <button class="buttonstyle" style="background-color: var(--available)" id="AVAILABLE" onclick="reply_click(this.id)">Available</button>
  </div> 
  <div class="circle deg-90">
    <button class="buttonstyle" style="background-color: var(--busy);" id="BUSY" onclick="reply_click(this.id)">Busy</button>
  </div>
  <div class="circle deg-180">
    <button class="buttonstyle" style="background-color: var(--donotdisturb);"id="DONOTDISTURB" onclick="reply_click(this.id)">Do not Disturb</button>
  </div>
  <div class="circle deg-270">
    <button class="buttonstyle" style="background-color: var(--away);"id="AWAY" onclick="reply_click(this.id)">Away</button>
  </div>

</article> 

<section class="BottomPanel">
  <div id="Home"><a href="index.html">Home</a></div>
  <div id="Housemates"><a href="housemates.html">Housemates</a></div>
  <div id="Settings"></div>
</section>
<script src="../core/common.js"></script>
<script>
  
  USER = null;
  url = window.location.href


  function makePerson() {
    text = document.querySelector("#name");
    name = text.value;

    if (USER == null) {
      USER = new Person(name);
      console.log("New User");
    }

    if (USER.name != name){
        USER = new Person(name);
        console.log("New User");
    }
    console.log("Same user");

  }

  async function reply_click(clicked_id)
  {
    USER.status = clicked_id;
    console.log(USER)

    updateMainScreen(clicked_id);

    var options = {method: "PUT", headers: {'Content-Type': 'application/json'}, body: USER.toJSON()}
    r = new Request(url, options=options)

    await fetch(r)

    

    //link with Github database
    // alert(clicked_id);
  }

  function updateMainScreen(status) {
    element = document.getElementById("middle");

    element.querySelectorAll("circle")[1].style.stroke = RESIDENTSTATUS[status];
  }

  function spawnQuestion() {
    template = document.getElementById("DialogBox");
    const clone = template.content.cloneNode(true);


  }
</script>
</body>

</html>
