
<!DOCTYPE html>

<html>
<!-- tutorial from stack overflow how to record ID https://stackoverflow.com/questions/4825295/onclick-to-get-the-id-of-the-clicked-button tutorial from stack overflow how to record ID https://stackoverflow.com/questions/4825295/onclick-to-get-the-id-of-the-clicked-button -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>replit</title>
  <link href="../core/common.css" rel="stylesheet" type="text/css" />
  <link href="style.css" rel="stylesheet" type="text/css" />
</head>

<body>
  <form>
    Please put your name: <input type="text" name= "name", id="name">
    <button id="textinput" type="button" onclick="makePerson()">Accept</button> 
  </form>
  <div > 
    Confirm location
  </div>
<article>
  <img src="test.jpg", width="5%">

  <button class="buttonstyle" id= "AVAILABLE" onclick="reply_click(this.id)">Available</button>
  <button class="buttonstyle" id= "BUSY" onclick="reply_click(this.id)">Busy</button>
  <button class="buttonstyle" id= "DONOTDISTURB" onclick="reply_click(this.id)">Do not Disturb</button>
  <button class="buttonstyle" id="AWAY" onclick="reply_click(this.id)">Away</button>
  

</article> 
<script>
  
  USER = null;
  url = window.location.href

  class Person {
    name;
    id;
    status;
    emoji;
    
    constructor(name, id) {
      this.name = name;
      this.id = name;
      this.status = "AVAILABLE";
      this.emoji = "ðŸ˜Š";
    }


    newStatus(status) {
      this.status = status;
    }

    toJSON() {

      return '{ "name":"' + this.name + '", "id":"' + this.id + '", "location": "HOME", "status": "' + this.status + '", "emoji": "'+ this.emoji + '"}'; 
    }
  }

  function makePerson() {
    text = document.querySelector("#name");
    name = text.value;

    if (USER == null) {
      USER = new Person(name);
      console.log("New User");
    }

    if (USER.name != name){
        USER = new Person(name);
        console.log("New User");
    }
    console.log("Same user");

  }

  async function reply_click(clicked_id)
  {
    USER.status = clicked_id;
    console.log(USER)

    var options = {method: "PUT", headers: {'Content-Type': 'application/json'}, body: USER.toJSON()}
    r = new Request(url, options=options)

    await fetch(r)

    

    //link with Github database
    // alert(clicked_id);
  }
</script>
</body>

</html>
